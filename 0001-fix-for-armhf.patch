From ba5fee90a6898acff898daa9c44e4e393eeacd65 Mon Sep 17 00:00:00 2001
From: Kei Okada <kei.okada@gmail.com>
Date: Wed, 18 Dec 2024 01:51:22 +0900
Subject: [PATCH 1/2] fix for armhf

---
 CMakeLists.txt | 13 +++++++++++++
 package.xml    |  1 +
 2 files changed, 14 insertions(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index b52a9bb298..247bf57e80 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -24,10 +24,23 @@ if($ENV{ROS_DISTRO} STREQUAL "indigo" OR $ENV{ROS_DISTRO} STREQUAL "kinetic" OR
     PYTHON_INTERPRETER python2
   )
 else()
+  execute_process(
+    COMMAND dpkg-architecture -qDEB_TARGET_ARCH
+    OUTPUT_VARIABLE DEB_TARGET_ARCH
+    OUTPUT_STRIP_TRAILING_WHITESPACE
+    )
+  message(STATUS "Debian target architecture: ${DEB_TARGET_ARCH}")
+  if("${DEB_TARGET_ARCH}" STREQUAL "armhf")
+  catkin_generate_virtualenv(
+    INPUT_REQUIREMENTS requirements.in.armhf
+    PYTHON_INTERPRETER python3
+  )
+  else()
   catkin_generate_virtualenv(
     INPUT_REQUIREMENTS requirements.in
     PYTHON_INTERPRETER python3
   )
+  endif()
 endif()
 
 file(GLOB SCRIPTS_FILES scripts/*)
diff --git a/package.xml b/package.xml
index 7c1ec75fd6..88f014b350 100644
--- a/package.xml
+++ b/package.xml
@@ -13,6 +13,7 @@
   <buildtool_depend condition="$ROS_PYTHON_VERSION == 3">python3-catkin-pkg-modules</buildtool_depend>
 
   <build_depend version_gte="0.5.1">catkin_virtualenv</build_depend>
+  <build_depend>libjpeg</build_depend>
 
   <exec_depend>audio_common_msgs</exec_depend>
   <exec_depend>cv_bridge</exec_depend>
-- 
2.17.1

